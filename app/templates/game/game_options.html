{% extends "system/base.html" %}
{% block title %}Game Options{% endblock %}

{% block content %}
    <!-- Existing content for saved games -->
    <div class="row mb-4">
        <div class="col">
            <h2>Saved Games</h2>
            <div class="d-flex flex-wrap gap-2 mb-3 align-items-end">
                <a href="{{ url_for('add_game') }}" class="btn btn-primary">Add New Game</a>
                <a href="{{ url_for('settings') }}" class="btn btn-secondary">Play Options Settings</a>
				<a href="{{ url_for('callsheet') }}{% if selected_team %}?Team={{ selected_team }}{% endif %}" class="btn btn-info">Callsheet</a>
			<form method="get" class="d-flex flex-column">
				<label for="Team">Away Team:</label>
					<select name="Team" id = "Team" class="form-select mb-2">
					<option value="">All Teams</option>
					{% for team in teams %}
					<option value="{{ team.name }}"
					{% if selected_team == team.name %} selected {%endif%}	
					>{{ team.name }}</option>
					{% endfor %}
					</select>
					<button type="submit"class = "btn btn-outline-primary">Filter</button>
            </div>
        </div>
    </div>

    <!-- Table wrapper -->
    <div class="my-table-wrapper">
        <div class="row">
            <div class="col">
                <div class="table-responsive">
                    <table class="table table-striped align-middle">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Game Name</th>
                                <th>Date/Time</th>
                                <th>Home Team</th>
                                <th>Away Team</th>
                                <th>Total Drives</th>
                                <th>Total Plays</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for game in games %}
                                <tr>
                                    <td>{{ game.id }}</td>
                                    <td>{{ game.name }}</td>
                                    <td>{{ game.date.strftime('%Y-%m-%d') }} {{ game.time }}</td>
                                    <td>{{ game.home_team_name }}</td>
                                    <td>{{ game.away_team_name }}</td>
                                    <td>{{ game.total_drives }}</td>
                                    <td>{{ game.total_plays }}</td>
                                    <td>
                                        <div class="d-flex align-items-center gap-1">
                                            <a href="{{ url_for('game_detail', game_id=game.id) }}"
                                               class="btn btn-sm btn-outline-primary"
                                               title="Go to Game">
                                                <i class="fas fa-eye"></i>
                                            </a>
                                            {% if current_user.role == 'admin' %}
                                                <form action="{{ url_for('delete_game', game_id=game.id) }}" method="POST"
                                                      onsubmit="return confirm('Delete this game?');" class="m-0 p-0">
                                                    <button type="submit" class="btn btn-sm btn-outline-danger" title="Delete Game">
                                                        <i class="fas fa-trash-alt"></i>
                                                    </button>
                                                </form>
                                            {% else %}
                                                <button class="btn btn-sm btn-outline-secondary" disabled title="Insufficient permissions">
                                                    <i class="fas fa-trash-alt"></i>
                                                </button>
                                            {% endif %}
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Button group style -->
    <style>
        .d-flex.gap-1 .btn {
            border-radius: 0;
        }

        .d-flex.gap-1 .btn:first-child {
            border-top-left-radius: 0.375rem;
            border-bottom-left-radius: 0.375rem;
        }

        .d-flex.gap-1 .btn:last-child {
            border-top-right-radius: 0.375rem;
            border-bottom-right-radius: 0.375rem;
        }

        .d-flex.gap-1 form {
            margin: 0;
            padding: 0;
        }

        .d-flex.gap-1 .btn i {
            pointer-events: none;
        }
    </style>
{% endblock %}
