{% extends "system/base.html" %}
{% block title %}Game Options{% endblock %}

{% block content %}
    <!-- Existing content for saved games -->
    <div class="row mb-4">
        <div class="col">
            <h2>Saved Games</h2>
            <div class="d-flex flex-wrap gap-2 mb-3 align-items-end">
                <a href="{{ url_for('add_game') }}" class="btn btn-primary">Add New Game</a>
                <a href="{{ url_for('settings') }}" class="btn btn-secondary">Play Options Settings</a>
				<a href="{{ url_for('callsheet') }}{% if selected_team %}?Team={{ selected_team }}{% endif %}" class="btn btn-info" id="callsheet-link">Callsheet</a>
            </div>
			<div class="d-flex mb-3">
				<div class="me-3">
				<label for="Team">Away Team:</label>
					<select name="Team" id = "Team" class="form-select mb-2">
					<option value="" selected >All Teams</option>
					{% for team in teams %}
					<option value="{{ team.name }}">{{ team.name }}</option>
					{% endfor %}
					</select>
				</div>
    </div>
	<div id="game-table-body">
							{%include 'game/partials/_game_rows.html' %}
						</div>

    <!-- Button group style -->
    <style>
        .d-flex.gap-1 .btn {
            border-radius: 0;
        }

        .d-flex.gap-1 .btn:first-child {
            border-top-left-radius: 0.375rem;
            border-bottom-left-radius: 0.375rem;
        }

        .d-flex.gap-1 .btn:last-child {
            border-top-right-radius: 0.375rem;
            border-bottom-right-radius: 0.375rem;
        }

        .d-flex.gap-1 form {
            margin: 0;
            padding: 0;
        }

        .d-flex.gap-1 .btn i {
            pointer-events: none;
        }
	</style>
	<script>
	 	document.addEventListener('DOMContentLoaded', () => {

		 	const select = document.getElementById('Team');
			select.value = "";
			const callsheetLink = document.getElementById('callsheet-link');
		 	select.addEventListener('change', (e) => {
				const selectedTeam = e.target.value;

				if (callsheetLink) {
					if (selectedTeam) {
						callsheetLink.href = `/callsheet?Team=${encodeURIComponent(selectedTeam)}`;
					} else {
						callsheetLink.href = `/callsheet`;
					}
				}
			 fetch(`/filter_games?Team=${encodeURIComponent(selectedTeam)}`)
				   .then(response => response.text())
				   .then(html => {
					   document.getElementById('game-table-body').innerHTML = html;
						 });
				   });
			});
	</script>

{% endblock %}
